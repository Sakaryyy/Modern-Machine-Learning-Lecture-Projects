paths:
  data_dir: /mnt/a/Modern_Machine_Learning_Lecture/Project_2_Image_Classification/data
  outputs_dir: /mnt/a/Modern_Machine_Learning_Lecture/Project_2_Image_Classification/outputs
  configs_dir: /mnt/a/Modern_Machine_Learning_Lecture/Project_2_Image_Classification/outputs/configs
  models_dir: /mnt/a/Modern_Machine_Learning_Lecture/Project_2_Image_Classification/outputs/models
  analysis_dir: /mnt/a/Modern_Machine_Learning_Lecture/Project_2_Image_Classification/outputs/analysis
  figures_dir: /mnt/a/Modern_Machine_Learning_Lecture/Project_2_Image_Classification/outputs/figures
training:
  num_epochs: 50
  batch_size: 128
  eval_batch_size: 256
  log_every: 100
  optimizer: adamw
  learning_rate: 0.001
  weight_decay: 0.0001
  scheduler: cosine_decay
  scheduler_kwargs:
    warmup_steps: 500
    alpha: 0.0
  loss: cross_entropy
  metrics:
    - loss
    - accuracy
  use_data_augmentation: true
baseline_defaults:
  hidden_units: 512
  activation: relu
  dropout_rate: 0.2
  use_bias: true
  kernel_init: he_normal
  bias_init: zeros
cnn_defaults:
  conv_blocks:
    - features: 32
      kernel_size:
        - 3
        - 3
      pooling_type: max
      dropout_rate: 0.1
    - features: 64
      kernel_size:
        - 3
        - 3
      pooling_type: max
      dropout_rate: 0.2
    - features: 128
      kernel_size:
        - 3
        - 3
      pooling_type: max
      dropout_rate: 0.3
  dense_blocks:
    - features: 256
      dropout_rate: 0.5
      activation: relu
    - features: 128
      dropout_rate: 0.3
      activation: relu
  classifier_dropout: 0.5
  global_average_pooling: true
  classifier_kernel_init: he_normal
  classifier_bias_init: zeros
  classifier_use_bias: true
ablation:
  parameters:
    optimizer:
      - adamw
      - sgd
      - rmsprop
    learning_rate:
      - 0.001
      - 0.005
      - 0.01
    weight_decay:
      - 0.0001
      - 0.0005
    momentum:
      - 0.85
      - 0.9
    scheduler:
      - constant
      - cosine_decay
      - linear_warmup_cosine_decay
      - exponential_decay
    warmup_steps:
      - 0
      - 250
      - 500
  baseline_model: baseline
  repeats: 1
  metric: validation_accuracy
  output_subdir: ablation
hyperparameter_search:
  search_space:
    conv_blocks:
      - - features: 32
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.1
        - features: 64
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.2
      - - features: 32
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.1
        - features: 64
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.2
        - features: 128
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.3
      - - features: 64
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.1
        - features: 128
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.2
        - features: 256
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.3
        - features: 256
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.35
      - - features: 32
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.1
        - features: 64
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.2
        - features: 128
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.25
        - features: 256
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.3
        - features: 512
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.4
      - - features: 64
          kernel_size:
            - 5
            - 5
          pooling_type: avg
          dropout_rate: 0.15
        - features: 128
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.25
        - features: 256
          kernel_size:
            - 3
            - 3
          pooling_type: max
          dropout_rate: 0.35
    dense_blocks:
      - - features: 512
          dropout_rate: 0.4
          activation: relu
        - features: 256
          dropout_rate: 0.3
          activation: relu
      - - features: 512
          dropout_rate: 0.4
          activation: relu
        - features: 256
          dropout_rate: 0.3
          activation: relu
        - features: 128
          dropout_rate: 0.2
          activation: relu
      - - features: 768
          dropout_rate: 0.4
          activation: relu
        - features: 384
          dropout_rate: 0.3
          activation: relu
    learning_rate:
      - 0.001
      - 0.005
      - 0.01
    weight_decay:
      - 0.0001
      - 0.0005
    optimizer:
      - adamw
      - rmsprop
    scheduler:
      - constant
      - cosine_decay
  evaluation_metric: validation_accuracy
  max_combinations: 120
  output_subdir: hyperparameter_search
